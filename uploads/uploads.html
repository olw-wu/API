<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NonSamplingReport</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-170079870-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-170079870-1');
  </script>
  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="uploads.css">
  <!--引入js文件-->
  <!--  <script type="text/javascript" src="account.js"></script>-->
  <!--引入外部库-->
  <!--  <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>-->
  <!--  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">

  <script type="text/javascript" src="https://apis.google.com/js/client.js"> </script>
  <link href="../node_modules/bootstrap/dist/css/bootstrap-theme.css" rel="stylesheet">

  <script src="../node_modules/jquery/dist/jquery.js"></script>

  <script src="../node_modules/bootstrap/dist/js/bootstrap.js"></script>
  <script src="https://apis.google.com/js/api.js"></script>

</head>
<body>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../AEManagementAPI.html">首页</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"><a href="../account/account.html">账户</a></li>
        <li><a href="../customDataSource/cnustomDataSource.html">自定义数据源</a></li>
        <li><a href="../test/test.html">实验</a></li>
        <li><a href="../filterCondition/filterCondition.html">过滤条件</a></li>
        <li><a href="../target/target.html">目标</a></li>
        <li><a href="../ProfileUserAssociation/ProfileUserAssociation.html">配置文件用户关联</a></li>
        <li><a href="../ToMarketing/ToMarketing.html">再营销受众群体</a></li>
        <li><a href="../subdivide/subdivide.html">细分</a></li>
        <li><a href="../NonSamplingReport/NonSamplingReport.html">非抽样报告</a></li>
        <li><a href="../uploads/uploads.html">uploads</a></li>
        <li><a href="../dataView/dataview.html">数据视图</a></li>
        <li><a href="../NetworkMediaResources/NetworkMediaResources.html">网络媒体资源</a></li>
        <li><a href="../NetworkMediaResourceUserAssociation/NetworkMediaResourceUserAssociation.html">网络媒体资源用户关联</a></li>

      </ul>
      <form class="navbar-form navbar-left">
        <div class="form-group">
          <label>
            <input type="text" class="form-control" placeholder="Search">
          </label>
        </div>
        <button type="submit" class="btn btn-default">搜索</button>
      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#">登录</a></li>
        <li><a href="#">注册</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">关于GA<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">GA账户</a></li>
            <li><a href="#">GA参考资料</a></li>
            <li><a href="#">GA常见问题</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">寻求帮助</a></li>
          </ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<button onclick="authenticate().then(loadClient)">授权和登录</button>


<!--删除-->
<div class="line5">
  <form class="navbar-form navbar-left"  role="search">
    <div class="form-group">
      <span>accountId:</span><label for="deleteAccount"></label><input type="text" class="form-control" placeholder="accountID" id="deleteAccount">
      <span>CustomDataSourceId:</span><label for="deleteCustomDataSource"></label><input type="text" class="form-control" placeholder="CustomDataSourceID" id="deleteCustomDataSource">
      <span>webPropertyId:</span><label for="deleteWebProperty"></label><input type="text" class="form-control" placeholder="webPropertyId" id="deleteWebProperty">

    </div>
    <button type="submit" class="btn btn-default" id="deleteBtn">删除uploads</button>
  </form>
</div>



<!--获取-->
<div class="line5">
  <form class="navbar-form navbar-left"  role="search">
    <div class="form-group">
      <span>accountId:</span><label for="getAccount"></label><input type="text" class="form-control" placeholder="accountID" id="getAccount">
      <span>CustomDataSourceIdId:</span><label for="getCustomDataSource"></label><input type="text" class="form-control" placeholder="CustomDataSourceID" id="getCustomDataSource">
      <span>webPropertyId:</span><label for="getWebProperty"></label><input type="text" class="form-control" placeholder="webPropertyId" id="getWebProperty">
      <span>uploadId:</span><label for="getUploadId"></label><input type="text" class="form-control" placeholder="UploadId" id="getUploadId">
    </div>
    <button type="submit" class="btn btn-default" id="getBtn">获取uploads</button>
  </form>
</div>


  <!--列表-->

  <div class="line7">
    <form class="navbar-form navbar-left"  role="search">
      <div class="form-group">
        <span>accountId:</span><label for="listAccount"></label><input type="text" class="form-control" placeholder="accountID" id="listAccount">
        <span>CustomDataSourceIdId:</span><label for="listCustomDataSource"></label><input type="text" class="form-control" placeholder="CustomDataSourceID" id="listCustomDataSource">
        <span>webPropertyId:</span><label for="listWebProperty"></label><input type="text" class="form-control" placeholder="webPropertyId" id="listWebProperty">
      </div>
      <button type="submit" class="btn btn-default" id="listBtn">读取uploads列表</button>
    </form>
  </div>


<!--更新数据-->
<div class="home1">
  <div class="line2">
    <form class="navbar-form navbar-left" role="search" >
      <div class="form-group">
        <span>accountId:（可选）</span><label for="insertAccount"></label><input type="text" class="form-control" placeholder="accountID" id="insertAccount">
        <span>CustomDataSourceIdId:（可选）</span><label for="insertCustomDataSource"></label><input type="text" class="form-control" placeholder="CustomDataSourceID" id="insertCustomDataSource">
        <span>webPropertyId:（可选）</span><label for="insertWebProperty"></label><input type="text" class="form-control" placeholder="webPropertyId" id="insertWebProperty">
      </div>
      <button type="submit" class="btn btn-default" id="insertBtn">uploads数据</button>
    </form>
  </div>


  <script>
    /**
     * Sample JavaScript code for analytics.management.uploads.list
     * See instructions for running APIs Explorer code samples locally:
     * https://developers.google.com/explorer-help/guides/code_samples#javascript
     */

    function authenticate() {
      return gapi.auth2.getAuthInstance()
        .signIn({scope: "https://www.googleapis.com/auth/analytics https://www.googleapis.com/auth/analytics.edit https://www.googleapis.com/auth/analytics.readonly"})
        .then(function() { console.log("Sign-in successful"); },
          function(err) { console.error("Error signing in", err); });
    }
    function loadClient() {
      gapi.client.setApiKey("AIzaSyAjZD1FxUocOEGADxxNVorrJuk3uPHVD8A");
      return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/analytics/v3/rest")
        .then(function() { console.log("GAPI client loaded for API"); },
          function(err) { console.error("Error loading GAPI client for API", err); });
    }

    // Make sure the client is loaded and sign-in is complete before calling this method.
    function execute() {
      const accountID = document.getElementById('deleteAccount').value;

      const webPropertyId = document.getElementById("deleteWebProperty").value;
      const customDataSourceId = document.getElementById('deleteCustomDataSourceId').value;
      return gapi.client.analytics.management.uploads.list({
      })

        .then(function(response) {
            // Handle the results here (response.result has the parsed body).
            console.log("Response", response);
          },
          function(err) { console.error("Execute error", err); });

    }
    gapi.load("client:auth2", function() {
      gapi.auth2.init({client_id: "7544542021-39d5r4jshfibkr85c05mc11m4fad9vvd.apps.googleusercontent.com"});
    });


  </script>

  <script>

    //删除

    const accountID = document.getElementById('deleteAccount').value;
    const CustomDataSourceId = document.getElementById('deleteCustomDataSource').value;
    const webPropertyId = document.getElementById("deleteWebProperty").value;

    document.getElementById('deleteBtn').addEventListener("click", function deleteAccountUserLink() {
      if (confirm("是否确定删除uploads？")){
        /*
 * Note: This code assumes you have an authorized Analytics client object.
 * See the Data Import Developer Guide for details.
 */

        /*
         * This request deletes a list of existing uploads.
         */
        function deleteUploads() {
          var request = gapi.client.analytics.management.uploads.deleteUploadData({
            'accountId': accountID,
            'webPropertyId': webPropertyId,
            'customDataSourceId': CustomDataSourceId,
            'resource': {
              'customDataImportUids': [CustomDataSourceId,
                'xLh4wXtzQT6uxe-_OWelog']
            }
          });
          request.execute(function (response) { // Handle the response. });
          });



        }}});


    // 获取uploads

    const accountID6 = document.getElementById('getAccount').value;
    const CustomDataSourceId6 = document.getElementById('getCustomDataSource').value;
    const webPropertyId6 = document.getElementById("getWebProperty").value;
    const uploadId6 = document.getElementById('getUploadId').value;
    document.getElementById('getBtn').addEventListener("click", function deleteAccountUserLink() {
      if (confirm("是否确定获取uploads？")){

        function getUpload() {
          var request = gapi.client.analytics.management.uploads.get({
            'accountId': accountID6,
            'webPropertyId': webPropertyId6,
            'customDataSourceId': CustomDataSourceId6,
            'uploadId': uploadId6
          });
          request.execute(function (response) { // Handle the response. });
          })


        }}});


    // uploads列表


    const accountID3 = document.getElementById('listAccount').value;
    const CustomDataSourceId3 = document.getElementById('listCustomDataSource').value;
    const webPropertyId3 = document.getElementById("listWebProperty").value;
    document.getElementById("listBtn").addEventListener("click", function listAccountUserLinks() {
      if (confirm("确认读取uploads列表？")){


        function listUploads() {
          var request = gapi.client.analytics.management.uploads.list({
            'accountId': accountID3,
            'webPropertyId': CustomDataSourceId3,
            'customDataSourceId': webPropertyId3,
          });
          request.execute(printUploads);
        }


        function printUploads(results) {
          if (results && !results.error) {
            var uploads = results.items;
            for (var i = 0, upload; upload = uploads[i]; i++) {
              console.log('Upload Id: ' + upload.id);
              console.log('Upload Kind: ' + upload.kind);
              console.log('Account Id: ' + upload.accountId);
              console.log('Data Set Id: ' + upload.customDataSourceId);
              console.log('Upload Status: ' + upload.status);
            }
          }
        }

      }});

    // uploads数据


    const accountID2 = document.getElementById('insertAccount').value;
    const CustomDataSource2 = document.getElementById('insertCustomDataSource').value;
    const webPropertyId2 = document.getElementById("insertWebProperty").value;
    document.getElementById('insertBtn').addEventListener("click", function insertAccountUserLink() {
      if (confirm("是否确认获取uploads数据？")){

        /*
 * Note: This code assumes you have an authorized Analytics client object.
 * See the Data Import Developer Guide for details.
 */

        /*
         * This request uploads a file for the authorized user.
         */
        function uploadData(fileData) {
          const boundary = '-------314159265358979323846';
          const delimiter = "\r\n--" + boundary + "\r\n";
          const close_delim = "\r\n--" + boundary + "--";

          var contentType = 'application/octet-stream'

          var reader = new FileReader();
          reader.readAsBinaryString(fileData);
          reader.onload = function(e) {
            var contentType = 'application/octet-stream';
            var metadata = {
              'title': fileData.name,
              'mimeType': contentType
            };

            var base64Data = btoa(reader.result);
            var multipartRequestBody =
              delimiter +
              'Content-Type: application/json\r\n\r\n' +
              JSON.stringify(metadata) +
              delimiter +
              'Content-Type: ' + contentType + '\r\n' +
              'Content-Transfer-Encoding: base64\r\n' +
              '\r\n' +
              base64Data +
              close_delim;

            var request = gapi.client.request({
              'path': 'upload/analytics/v3/management/accounts/123456/webproperties/UA-123456-1/customDataSources/ABCDEFG123abcDEF123/uploads',
              'method': 'POST',
              'params': {'uploadType': 'multipart'},
              'headers': {
                'Content-Type': 'multipart/mixed; boundary="' + boundary + '"'
              },
              'body': multipartRequestBody
            });
            request.execute(function (response) { // Handle the response. });
            })
          }



        }}});

  </script>
  <script src="https://apis.google.com/js/client.js?onload=authorize"></script>
</body>
</html>
